## 百分比计算
### 思路
1、使用impala自定义聚合函数（UDAF），传入字段名和筛选条件，得到该条件下，该字段的总和（SUM_TOTAL）

2、求百分比字段/SUM_TOTAL
### 举例说明
统计30岁以下，每个人的收入，及每人收入的占比
```
    SELECT
      `name` AS '姓名',
      SUM(money) AS '收入',
      money /
      (SELECT   
    SUM(money)
      FROM
    test
      WHERE age < 30) AS '收入占比'
    FROM
      test
    WHERE age < 30
    GROUP BY `name`
```
该百分比函数替换的正是此处的子查询语句

## 同环比计算
### 维度条件中包含日期字段
1、包含一个日期字段
指标中的所有同环比计算字段，按照维度日期字段和粒度进行计算
2、包含多个日期字段
指标中的所有同环比计算字段，按照最后一个日期字段和其粒度进行计算
### 维度条件中不包含日期字段

### 自定义日期时间段

### 同比计算

### 环比计算

### 同环比字段排序

